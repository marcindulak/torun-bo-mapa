<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Toru≈Ñ Budget Visualization</title>
    <link rel="stylesheet" href="https://unpkg.com/leaflet@2.0.0-alpha.1/dist/leaflet.css" />
    <style>
        body {
            margin: 0;
            padding: 0;
            font-family: Arial, sans-serif;
        }
        #map {
            height: 100vh;
            width: 100%;
        }
        .year-selector {
            background: white;
            padding: 10px;
            border-radius: 4px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.2);
        }
        .year-selector label {
            margin-right: 8px;
            font-weight: 500;
        }
        .year-selector select {
            padding: 6px 12px;
            border: 2px solid #333;
            background: white;
            cursor: pointer;
            border-radius: 4px;
            font-size: 14px;
            font-weight: 500;
            width: 100%;
            box-sizing: border-box;
        }
        .year-selector button {
            padding: 6px 12px;
            border: 2px solid #333;
            background: white;
            cursor: pointer;
            border-radius: 4px;
            font-size: 14px;
            font-weight: 500;
            width: 100%;
            box-sizing: border-box;
            margin-bottom: 8px;
        }
        .year-selector button:hover {
            background: #f0f0f0;
        }
        .year-selector .control-group {
            margin-bottom: 8px;
        }
    </style>
    <script type="module">
        import { Map, TileLayer, Marker, DivIcon, Control } from 'https://unpkg.com/leaflet@2.0.0-alpha.1/dist/leaflet.js';

      const DATA_BY_YEAR = {
          '2024': [
          {
    "name": "Powiƒôkszmy park na Bydgoskim - porzƒÖdki od Mart√≥wki w stronƒô Wis≈Çy.",
    "location": "Obszar od ulicy Popie≈Çuszki (bez dzia≈Çek ROD) w stronƒô wschodniƒÖ.",
    "address": "Popie≈Çuszki",
    "address_manual": "",
    "value": 300000,
    "category": "900",
    "description": "Powiƒôkszmy park na Bydgoskim - porzƒÖdki od Mart√≥wki w\nstronƒô Wis≈Çy.\nObszar od ulicy Popie≈Çuszki (bez dzia≈Çek ROD) w stronƒô\nwschodniƒÖ.\nZakres: zebranie i utylizacja odpad√≥w, przyciƒôcie drzew,\nuprzƒÖtniƒôcie ga≈Çƒôzi.",
    "lat": 53.0078988,
    "lon": 18.5958283
  },
  {
    "name": "Odtworzenie zieleni na wej≈õciu do Parku Miejskiego od ul. Konopnickiej.",
    "location": "Dz. nr 125/2 w ob. 12.",
    "address": "",
    "address_manual": "",
    "value": 60000,
    "category": "900",
    "description": "Odtworzenie zieleni na wej≈õciu do Parku Miejskiego od ul.\nKonopnickiej.\nDz. nr 125/2 w ob. 12.\nZakres: nasadzenia drzew i urzƒÖdzenie ro≈õlinno≈õci niskiej w\nobrƒôbie zabytkowej czƒô≈õci Parku Miejskiego."
  },
  {
    "name": "Strefa dobrego czasu.",
    "location": "Ul. Fa≈Çata 96, Toru≈Ñ.",
    "address": "Fa≈Çata 96",
    "address_manual": "",
    "value": 95000,
    "category": "926",
    "description": "Strefa dobrego czasu.\nUl. Fa≈Çata 96, Toru≈Ñ. Teren zielony przy budynku SP 11 (w\nobiekcie przebywajƒÖ uczniowie klas 1-3) graniczƒÖcy z siedzibƒÖ\nStowarzyszenia \"Jestem\". Okolice ul. Broniewskiego,\nGagarina, Reja. Teren le≈ºy w otoczeniu blok√≥w mieszkalnych.\nJest og√≥lnodostƒôpny dla mieszka≈Ñc√≥w.\nZakres: st√≥≈Ç do tenisa sto≈Çowego, stolik z polami do gry w\nszachy, tablice do rysowania kredƒÖ.",
    "lat": 53.015838,
    "lon": 18.5644642
  },
  {
    "name": "Rowerowe i piesze udogodnienia na Bydgoskim.",
    "location": "Obszar ca≈Çego Bydgoskiego Przedmie≈õcia.",
    "address": "",
    "address_manual": "",
    "value": 60000,
    "category": "600",
    "description": "Rowerowe i piesze udogodnienia na Bydgoskim.\nObszar ca≈Çego Bydgoskiego Przedmie≈õcia.\nOgraniczenie zakresu projektu: wyremontowanie chodnika\nwzd≈Çu≈º ul. S≈Çowackiego w kierunku ulicy Lindego do stacji\nbenzynowej."
  },
  {
    "name": "LepszeSwiatlo.pl.",
    "location": "Ulice: Chopina, Danielewskiego, Rybaki, Bydgoska, Mickiewicza i Park Miejski.",
    "address": "",
    "address_manual": "",
    "value": 138313,
    "category": "600",
    "description": "LepszeSwiatlo.pl.\nUlice: Chopina, Danielewskiego, Rybaki, Bydgoska,\nMickiewicza i Park Miejski.\nWymiana 56 opraw ledowych ."
  },
  {
    "name": "Akcja reaktywacja, czyli plac zabaw na piƒÖtkƒô przy \"PiƒÖtce\"!!!",
    "location": "Ul. ≈ªwirki i Wigury 1, 87-100 Toru≈Ñ przy SP 5 im. R. Traugutta w Toruniu.",
    "address": "≈ªwirki i Wigury 1",
    "address_manual": "",
    "value": 300000,
    "category": "801",
    "description": "Akcja reaktywacja, czyli plac zabaw na piƒÖtkƒô przy \"PiƒÖtce\"!!!\nUl. ≈ªwirki i Wigury 1, 87-100 Toru≈Ñ przy SP 5 im. R. Traugutta\nw Toruniu. Teren placu zabaw znajduje siƒô z ty≈Çu szko≈Çy u\nzbiegu ulic Hurynowicz i D≈Çugiej.\nZakres: urzƒÖdzenia zabawowe, kosz na ≈õmieci, dwie ≈Çawki\nzwyk≈Çe, ≈Çawka solarna, lampy led, nawierzchnia bezpieczna.",
    "lat": 53.0286572,
    "lon": 18.5860307
  },
  {
    "name": "Nauka i relaks w ZSPSiLO8 w Toruniu.",
    "location": "ZSPSiLO8, ul. Grunwaldzka 33.",
    "address": "Grunwaldzka 33",
    "address_manual": "",
    "value": 170000,
    "category": "801",
    "description": "Nauka i relaks w ZSPSiLO8 w Toruniu.\nZSPSiLO8, ul. Grunwaldzka 33.\nZakres: zewnƒôtrzna sala edukacyjna, monta≈º o≈õmiu\nmetalowych sto≈Ç√≥w ze stali nierdzewnej i 22 ≈Çawek, pod≈Ço≈ºe\nwykonane z polbruku, kosz na ≈õmieci, poide≈Çko dla ptak√≥w,\nnasadzenie kwiat√≥w cebulowych i magnolii.",
    "lat": 53.0247738,
    "lon": 18.5859321
  },
  {
    "name": "Utworzenie si≈Çowni zewnƒôtrznej przy Hospicjum Jana Paw≈Ça II w Toruniu.",
    "location": "Centrum Opieki Medycznej Hospicjum im. Jana Paw≈Ça II.",
    "address": "",
    "address_manual": "",
    "value": 72968,
    "category": "926",
    "description": "Utworzenie si≈Çowni zewnƒôtrznej przy Hospicjum Jana Paw≈Ça II\nw Toruniu.\nCentrum Opieki Medycznej Hospicjum im. Jana Paw≈Ça II.\nZakres: zmiana miejsca inwestycji, na dzia≈Çkƒô nr 42, kt√≥ra jest\notwarta i stale dostƒôpna, urzƒÖdzenia do ƒáwicze≈Ñ, nawierzchnia\nutwardzona."
  },
  {
    "name": "Modernizacja i rewitalizacja boiska wielofunkcyjnego przy ul. Zdrojowej / W≈Çoc≈Çawskiej w Toruniu - Czerniewicach.",
    "location": "U zbiegu ul. Zdrojowej / W≈Çoc≈Çawskiej w Toruniu - Czerniewicach.",
    "address": "Zdrojowej / W≈Çoc≈Çawskiej",
    "address_manual": "",
    "value": 60000,
    "category": "926",
    "description": "Modernizacja i rewitalizacja boiska wielofunkcyjnego przy ul.\nZdrojowej / W≈Çoc≈Çawskiej w Toruniu - Czerniewicach.\nU zbiegu ul. Zdrojowej / W≈Çoc≈Çawskiej w Toruniu -\nCzerniewicach.\nZakres: realizacja do limitu ≈õrodk√≥w: monta≈º dw√≥ch s≈Çup√≥w z\no≈õwietleniem LED, monta≈º opasek wzd≈Çu≈º dolnej czƒô≈õci\nogrodzenia, czyszczenie nawierzchni boiska, monta≈º dw√≥ch\ns≈Çup√≥w konstrukcyjnych z wysiƒôgnikiem."
  },
  {
    "name": "XXV Parafialno-Patriotyczny Festyn \"Tu sƒÖ moje Czerniewice\".",
    "location": "Ul. W≈Çoc≈Çawska 256 - plac przy ko≈õciele.",
    "address": "W≈Çoc≈Çawska 256 -",
    "address_manual": "",
    "value": 35000,
    "category": "900",
    "description": "XXV Parafialno-Patriotyczny Festyn \"Tu sƒÖ moje Czerniewice\".\nUl. W≈Çoc≈Çawska 256 - plac przy ko≈õciele.\nZakres: organizacja festynu: arty≈õci, zaplecze techniczne\n(scena, namioty, nag≈Ço≈õnienie, o≈õwietlenie, transport),\nnagrody na loteriƒô, atrakcje i animacje dla dzieci. Bez\nmo≈ºliwo≈õci finansowania wydatk√≥w na gastronomiƒô.",
    "lat": 52.9751076,
    "lon": 18.6843826
  },
  {
    "name": "OM Solanki - utworzenie nowych miejsc parkingowych.",
    "location": "Ul. Solankowa na wysoko≈õci budynk√≥w nr 38-38c i 40-40a.",
    "address": "Solankowa",
    "address_manual": "",
    "value": 76219,
    "category": "600",
    "description": "OM Solanki - utworzenie nowych miejsc parkingowych.\nUl. Solankowa na wysoko≈õci budynk√≥w nr 38-38c i 40-40a.\nZakres: ograniczenie zakresu prac do 10 miejsc postojowych\nwraz z oznakowaniem, nasadzenia ro≈õlin.",
    "lat": 52.9835468,
    "lon": 18.6834043
  },
  {
    "name": "Szko≈Ça pod ≈ºaglami - SP 34 w Toruniu.",
    "location": "Szko≈Ça Podstawowa nr 34 im. Tony'ego Halika.",
    "address": "",
    "address_manual": "",
    "value": 90000,
    "category": "801",
    "description": "Szko≈Ça pod ≈ºaglami - SP 34 w Toruniu.\nSzko≈Ça Podstawowa nr 34 im. Tony'ego Halika.\nZakres: nawierzchnia trawiasta z matami przerostowymi,\n≈Çawosto≈Çy, ≈ºagiel, zmiana na innƒÖ lokalizacjƒô na terenie szko≈Çy\nz uwagi na du≈ºƒÖ ilo≈õƒá sieci biegnƒÖcych we wskazanym miejscu."
  },
  {
    "name": "Ziele≈Ñ ozdobna przy ul. Zdrojowej na o≈õ.",
    "location": "Czerniewice.",
    "address": "Czerniewice",
    "address_manual": "",
    "value": 20000,
    "category": "900",
    "description": "Ziele≈Ñ ozdobna przy ul. Zdrojowej na o≈õ. Czerniewice.\nPas drogowy w ul. Zdrojowej, od strony dom√≥w\njednorodzinnych, na odcinku od ul. Radosnej do posesji nr 24.\nZakres: nasadzenia ro≈õlin ozdobnych i wykonanie element√≥w\nwyko≈Ñczeniowych - kora drzewna/kamie≈Ñ ozdobny.",
    "lat": 52.9795233,
    "lon": 18.6844918
  },
  {
    "name": "Budowa dw√≥ch ≈Çawek kamiennych przy Kamiennym Krƒôgu.",
    "location": "Zbieg ul. Olszty≈Ñska i Przeskok.",
    "address": "Olszty≈Ñska i Przeskok",
    "address_manual": "",
    "value": 15000,
    "category": "900",
    "description": "Budowa dw√≥ch ≈Çawek kamiennych przy Kamiennym Krƒôgu.\nZbieg ul. Olszty≈Ñska i Przeskok. Bezpo≈õrednie sƒÖsiedztwo\nkamiennego krƒôgu.\nZakres: dwie ≈Çawki kamienne wraz z tablicƒÖ informacyjnƒÖ."
  },
  {
    "name": "Rewitalizacja placu zabaw.",
    "location": "Motyw przewodni: D≈ºungla.",
    "address": "",
    "address_manual": "",
    "value": 190000,
    "category": "926",
    "description": "Rewitalizacja placu zabaw. Motyw przewodni: D≈ºungla.\nR√≥g ul. ≈ÅƒÖkowej i ul. Sczanieckiego na istniejƒÖcym placu\nzabaw.\nZakres: zestaw zabawowy ze zje≈ºd≈ºalniami, ≈õciankƒÖ\nwspinaczkowƒÖ, rurƒÖ do przechodzenia, tablicami aktywno≈õci\nJungle, bujak s≈Ço≈Ñ, lew, hu≈õtawka wagowa typu wa≈ºka na\nsprƒô≈ºynach, hu≈õtawka wieloosobowa z siedziskiem typu\nbocianie gniazdo, karuzela tarczowa, hu≈õtawka rodzinna,\nnawierzchnia bezpieczna."
  },
  {
    "name": "≈öcie≈ºka edukacyjna w SP 2.",
    "location": "Ul. Targowa 14/17.",
    "address": "Targowa",
    "address_manual": "",
    "value": 120000,
    "category": "801",
    "description": "≈öcie≈ºka edukacyjna w SP 2.\nUl. Targowa 14/17.\nZakres: monta≈º ko≈Çyski Newtona, kompasu, zegara\ns≈Çonecznego, ko≈Ça optycznego, ≈Çawek, dokonanie nasadze≈Ñ\nkrzew√≥w.",
    "lat": 53.0229819,
    "lon": 18.6336962
  },
  {
    "name": "Siatk√≥wka pla≈ºowa na Batorego!",
    "location": "Boisko sportowe przy ZSI≈ö, ul. Batorego 43/49.",
    "address": "ZSI≈ö",
    "address_manual": "",
    "value": 281191,
    "category": "801",
    "description": "Siatk√≥wka pla≈ºowa na Batorego!\nBoisko sportowe przy ZSI≈ö, ul. Batorego 43/49.\nZakres: budowa boiska do gry w pi≈Çkƒô siatkowƒÖ pla≈ºowƒÖ,\ndoko≈Ñczenie ogrodzenia boiska do gry w pi≈Çkƒô no≈ºnƒÖ\npi≈Çkochwytami, modernizacja ciƒÖg√≥w pieszych."
  },
  {
    "name": "Nowe wyposa≈ºenie na torze speedrowerowym w Kaszczorku.",
    "location": "Ul. Skierki, Toru≈Ñ.",
    "address": "Skierki",
    "address_manual": "",
    "value": 170000,
    "category": "926",
    "description": "Nowe wyposa≈ºenie na torze speedrowerowym w Kaszczorku.\nUl. Skierki, Toru≈Ñ. Dzia≈Çka nr 253/24.\nZakres: zakup i monta≈º dw√≥ch trybun dwurzƒôdowych 20\nmiejscowych, uzupe≈Çnienie nawierzchni, monta≈º lampy na\njednym z ≈Çuk√≥w o≈õwietlajƒÖcych tor, wykonanie toru do gry w\nkapsle oraz ogrodu spo≈Çecznego.",
    "lat": 53.0059242,
    "lon": 18.7052517
  },
  {
    "name": "Budowa wjazdu na teren rekreacyjny przy ul. Go≈õcinnej.",
    "location": "Kaszczorek, ul. Go≈õcinna 14.",
    "address": "Go≈õcinna 14",
    "address_manual": "",
    "value": 30000,
    "category": "600",
    "description": "Budowa wjazdu na teren rekreacyjny przy ul. Go≈õcinnej.\nKaszczorek, ul. Go≈õcinna 14.\nZakres: utworzenie zjazdu z ulicy Go≈õcinnej 14 w kierunku\ntoru speedrowerowego oraz ca≈Çego terenu rekreacyjnego.",
    "lat": 53.0061255,
    "lon": 18.7011698
  },
  {
    "name": "Przysta≈Ñ Bia≈Çe G√≥ry - Kaszczorek Zakole.",
    "location": "Kaszczorek, ul. Zakole.",
    "address": "Zakole",
    "address_manual": "",
    "value": 111918,
    "category": "926",
    "description": "Przysta≈Ñ Bia≈Çe G√≥ry - Kaszczorek Zakole.\nKaszczorek, ul. Zakole.\nZakres: monta≈º trzech drewnianych ≈Çawek, naprawa ogniska i\n≈Çawek przy ognisku, tablica informacyjna, wymiana\nnawierzchni pla≈ºowej, pomost dla kajak√≥w, kosze na ≈õmieci,\nteren biwakowy.",
    "lat": 53.0027818,
    "lon": 18.7099325
  },
  {
    "name": "Doko≈Ñczenie remontu kociarni i czƒô≈õci socjalnej w Schronisku dla Bezdomnych ZwierzƒÖt.",
    "location": "Schronisko dla bezdomnych zwierzƒÖt, ul. Przybyszewskiego 3.",
    "address": "Przybyszewskiego 3",
    "address_manual": "",
    "value": 1200000,
    "category": "900",
    "description": "Doko≈Ñczenie remontu kociarni i czƒô≈õci socjalnej w Schronisku\ndla Bezdomnych ZwierzƒÖt.\nSchronisko dla bezdomnych zwierzƒÖt, ul. Przybyszewskiego 3.\nZakres: doko≈Ñczenie remontu piƒôtra kociarni, kompleksowy\nremont czƒô≈õci socjalnej, zakup brakujƒÖcego wyposa≈ºenia w\nwyremontowanych pomieszczeniach.",
    "lat": 53.0086316,
    "lon": 18.5682376
  },
  {
    "name": "Zakup specjalistycznego pojazdu do ratowania zwierzƒÖt dla patrolu EKO Stra≈ºy Miejskiej w Toruniu.",
    "location": "Toru≈Ñ",
    "address": "Toru≈Ñ",
    "address_manual": "",
    "value": 350000,
    "category": "754",
    "description": "Zakup specjalistycznego pojazdu do ratowania zwierzƒÖt dla\npatrolu EKO Stra≈ºy Miejskiej w Toruniu.\nToru≈Ñ\nZakres: zakup specjalistycznego samochodu do ratowania\nzwierzƒÖt przeznaczonego dla Stra≈ºy Miejskiej."
  },
  {
    "name": "Samoch√≥d i wyposa≈ºenie dla OSP Toru≈Ñ Jar z psami ratowniczymi.",
    "location": "Siedziba Stowarzyszenia znajduje siƒô w domu parafialnym na Jarze, przy ul. Grasera 5, tam sprzƒôt bƒôdzie przechowywany.",
    "address": "Grasera 5",
    "address_manual": "",
    "value": 410000,
    "category": "754",
    "description": "Samoch√≥d i wyposa≈ºenie dla OSP Toru≈Ñ Jar z psami\nratowniczymi.\nSiedziba Stowarzyszenia znajduje siƒô w domu parafialnym na\nJarze, przy ul. Grasera 5, tam sprzƒôt bƒôdzie przechowywany.\nSamoch√≥d stacjonowaƒá mo≈ºe r√≥wnie≈º na terenie KM PSP w\nToruniu przy ul. Legion√≥w 70/76. Wykorzystywany bƒôdzie na\nterenie Torunia.\nZakres: zakup i zabudowa pojazdu Ochotniczej Stra≈ºy\nPo≈ºarnej, zakup wyposa≈ºenia stra≈ºak√≥w i dla ps√≥w\nratowniczych.",
    "lat": 53.0501209,
    "lon": 18.6020347
  },
  {
    "name": "Pomoc kotom bezdomnym.",
    "location": "Teren Gminy Miasta Toru≈Ñ.",
    "address": "",
    "address_manual": "",
    "value": 45000,
    "category": "900",
    "description": "Pomoc kotom bezdomnym.\nTeren Gminy Miasta Toru≈Ñ.\nZakres: zakup karmy oraz 15 drewnianych, ocieplanych budek\ndla kot√≥w wolno≈ºyjƒÖcych."
  },
  {
    "name": "Kolacje (drugi posi≈Çek) dla przebywajƒÖcych w Miejskim Schronisku dla Bezdomnych Mƒô≈ºczyzn w Toruniu.",
    "location": "Miejskie Schronisko dla Bezdomnych Mƒô≈ºczyzn, ul. M. Sk≈Çodowskiej-Curie 82-84, Toru≈Ñ.",
    "address": "M",
    "address_manual": "",
    "value": 650000,
    "category": "852",
    "description": "Kolacje (drugi posi≈Çek) dla przebywajƒÖcych w Miejskim\nSchronisku dla Bezdomnych Mƒô≈ºczyzn w Toruniu.\nMiejskie Schronisko dla Bezdomnych Mƒô≈ºczyzn, ul. M.\nSk≈Çodowskiej-Curie 82-84, Toru≈Ñ.\nZakres: kolacje przez ca≈Çy rok dla os√≥b przebywajƒÖcych w\nMiejskim Schronisku dla Bezdomnych Mƒô≈ºczyzn oraz w\nNoclegowni. NastƒÖpi≈Ça zmiana zakresu poprzez objƒôcie\nprojektem os√≥b przebywajƒÖcych w noclegowni.",
    "lat": 53.0102721,
    "lon": 18.6048094
  },
  {
    "name": "Dwujƒôzyczno≈õƒá z angielskim w ka≈ºdym toru≈Ñskim przedszkolu.",
    "location": "Wszystkie plac√≥wki przedszkolne publiczne w Toruniu.",
    "address": "",
    "address_manual": "",
    "value": 200000,
    "category": "801",
    "description": "Dwujƒôzyczno≈õƒá z angielskim w ka≈ºdym toru≈Ñskim przedszkolu.\nWszystkie plac√≥wki przedszkolne publiczne w Toruniu.\nZakres: pilota≈º zajƒôƒá w maksymalnie 9 toru≈Ñskich\nprzedszkolach, kt√≥re zg≈ÇoszƒÖ udzia≈Ç w pilota≈ºu."
  },
  {
    "name": "Rubinkowo na sportowo.",
    "location": "Og√≥lnodostƒôpny plac zabaw przy ul. Rydygiera 10, 11, 13, 15, 17, 9, 25, 27.",
    "address": "Rydygiera 10",
    "address_manual": "",
    "value": 95000,
    "category": "926",
    "description": "Rubinkowo na sportowo.\nOg√≥lnodostƒôpny plac zabaw przy ul. Rydygiera 10, 11, 13, 15,\n17, 9, 25, 27. Dzia≈Çka 046301_1.0051.21/69.\nZakres: hu≈õtawka potr√≥jna, zjazd na linie pojedynczy, system\nsprawno≈õciowy Ziemia II, zestaw dla ma≈Çych dzieci Tunel i\nmost linowy, trampolina, kosz chwytak, nawierzchnia\npiaszczysta.",
    "lat": 53.0254963,
    "lon": 18.656998
  },
  {
    "name": "Z≈Çota rƒÖczka dla seniora - Toru≈Ñ 2025.",
    "location": "Ca≈Çy Toru≈Ñ.",
    "address": "Toru≈Ñ",
    "address_manual": "",
    "value": 81287,
    "category": "853",
    "description": "Z≈Çota rƒÖczka dla seniora - Toru≈Ñ 2025.\nCa≈Çy Toru≈Ñ.\nZakres: projekt zak≈Çada wykonanie 200 us≈Çug na rzecz\nsenior√≥w."
  },
  {
    "name": "KwitnƒÖce wi≈õnie wok√≥≈Ç Star√≥wki.",
    "location": "1) Zielona Brama Gotyckiej Atar√≥wki - aleja r√≥wnoleg≈Ça do alei Solidarno≈õci; 2) skwer L. Broniewicza - aleja dochodzƒÖca do fontanny Cosmopolis; 3) teren zielony miƒôdzy CKK a ul. Odrodzenia.",
    "address": "Odrodzenia",
    "address_manual": "",
    "value": 45000,
    "category": "900",
    "description": "KwitnƒÖce wi≈õnie wok√≥≈Ç Star√≥wki.\n1) Zielona Brama Gotyckiej Atar√≥wki - aleja r√≥wnoleg≈Ça do alei\nSolidarno≈õci; 2) skwer L. Broniewicza - aleja dochodzƒÖca do\nfontanny Cosmopolis; 3) teren zielony miƒôdzy CKK a ul.\nOdrodzenia.\nZakres: ograniczenie do 20-25 drzew, muzeum\netnograficznym na terenie skweru, teren CKK Jordanki.",
    "lat": 53.0159817,
    "lon": 18.6054007
  },
  {
    "name": "Biblioteka w kieszeni - bezp≈Çatny dostƒôp do e-book√≥w w KsiƒÖ≈ºnicy.",
    "location": "Wojew√≥dzka Biblioteka Publiczna - KsiƒÖ≈ºnica Kopernika≈Ñska w Torunia, ul. S≈Çowackiego 8.",
    "address": "S≈Çowackiego 8",
    "address_manual": "",
    "value": 60000,
    "category": "921",
    "description": "Biblioteka w kieszeni - bezp≈Çatny dostƒôp do e-book√≥w w\nKsiƒÖ≈ºnicy.\nWojew√≥dzka Biblioteka Publiczna - KsiƒÖ≈ºnica Kopernika≈Ñska w\nTorunia, ul. S≈Çowackiego 8.\nZakres: zmiana: wyb√≥r dostawcy kod√≥w dokona KsiƒÖ≈ºnica\nkopernika≈Ñska jak r√≥wnie≈º wyboru tytu≈Ç√≥w do wysoko≈õci\nuzyskanych ≈õrodk√≥w.",
    "lat": 53.0132379,
    "lon": 18.5955567
  },
  {
    "name": "Podg√≥rski Piknik Rodzinny.",
    "location": "Ul. Pozna≈Ñska 49, tereny zielone przed ko≈õcio≈Çem ≈õw. Piotra i Paw≈Ça.",
    "address": "Pozna≈Ñska 49",
    "address_manual": "",
    "value": 35000,
    "category": "900",
    "description": "Podg√≥rski Piknik Rodzinny.\nUl. Pozna≈Ñska 49, tereny zielone przed ko≈õcio≈Çem ≈õw. Piotra i\nPaw≈Ça.\nZakres: zespo≈Çy muzyczne, wynajƒôcie sceny z nag≈Ço≈õnieniem,\nanimacja dla dzieci, bez mo≈ºliwo≈õci finansowania wydatk√≥w\nna gastronomiƒô.",
    "lat": 52.9939933,
    "lon": 18.5981209
  },
  {
    "name": "Bajeczny plac zabaw na Glinkach.",
    "location": "Dzia≈Çka 44/10 z obrƒôbu nr 77 lub inna w okolicy osiedla \"Glinki\" spe≈ÇniajƒÖca odpowiednie wymogi.",
    "address": "Glinki",
    "address_manual": "",
    "value": 300000,
    "category": "926",
    "description": "Bajeczny plac zabaw na Glinkach.\nDzia≈Çka 44/10 z obrƒôbu nr 77 lub inna w okolicy osiedla\n\"Glinki\" spe≈ÇniajƒÖca odpowiednie wymogi.\nZakres: Rodeobord- platforma na sprƒô≈ºynach, karuzela\nobrotowa stojƒÖca, dwie bezpieczne karuzele typu gniazdo,\nzestaw wspinaczkowy po≈ÇƒÖczony mostem z przeszkodami,\ndwie trampoliny ziemne, tyrolka, bezpieczna nawierzchnia.",
    "lat": 52.9705299,
    "lon": 18.5576347
  },
  {
    "name": "Szkolny Dzie≈Ñ Dziecka na 2025 rok.",
    "location": "Ul. Paderewskiego 5/11 w Toruniu.",
    "address": "Paderewskiego",
    "address_manual": "",
    "value": 35000,
    "category": "801",
    "description": "Szkolny Dzie≈Ñ Dziecka na 2025 rok.\nUl. Paderewskiego 5/11 w Toruniu.\nZakres: organizacja festynu, bez mo≈ºliwo≈õci finansowania\nwydatk√≥w na gastronomiƒô.",
    "lat": 52.9912151,
    "lon": 18.5912776
  },
  {
    "name": "Parking wzd≈Çu≈º ul. Inowroc≈Çawskiej.",
    "location": "Ul. Inowroc≈Çawska (mniej wiƒôcej naprzeciwko numer√≥w 6-18, w okolicach si≈Çowni zewnƒôtrznej).",
    "address": "Inowroc≈Çawska",
    "address_manual": "",
    "value": 73577,
    "category": "600",
    "description": "Parking wzd≈Çu≈º ul. Inowroc≈Çawskiej.\nUl. Inowroc≈Çawska (mniej wiƒôcej naprzeciwko numer√≥w 6-18,\nw okolicach si≈Çowni zewnƒôtrznej).\nZakres: budowa dw√≥ch parking√≥w r√≥wnoleg≈Çych na wysoko≈õci\ndzia≈Çek nr 600 i 599 obrƒôb nr 70.",
    "lat": 52.9903925,
    "lon": 18.5898534
  },
  {
    "name": "Boisko pe≈Çne sportu.",
    "location": "Boisko do koszyk√≥wki na wysoko≈õci bloku mieszkalnego Rydygiera 40 w Toruniu.",
    "address": "Rydygiera 40",
    "address_manual": "",
    "value": 300000,
    "category": "926",
    "description": "Boisko pe≈Çne sportu.\nBoisko do koszyk√≥wki na wysoko≈õci bloku mieszkalnego\nRydygiera 40 w Toruniu.\nZakres: zmiana nawierzchni na poliuretanowƒÖ, zmiana tablic\nwraz z obrƒôczami do koszyk√≥wki, monta≈º s≈Çupk√≥w do\nsiatk√≥wki wraz z siatkƒÖ, ogrodzenie boiska, monta≈º ≈Çawek i\nkoszt na ≈õmieci.",
    "lat": 53.0302135,
    "lon": 18.6479707
  },
  {
    "name": "≈öcie≈ºka sensoryczna zewnƒôtrzna - aktywne zmys≈Çy.",
    "location": "Rubinkowo, ul. Dziewulskiego 41b, tereny zielone przed Szko≈ÇƒÖ PodstawowƒÖ nr 31 im. gen. Hallera.",
    "address": "Dziewulskiego 41b",
    "address_manual": "",
    "value": 60000,
    "category": "801",
    "description": "≈öcie≈ºka sensoryczna zewnƒôtrzna - aktywne zmys≈Çy.\nRubinkowo, ul. Dziewulskiego 41b, tereny zielone przed\nSzko≈ÇƒÖ PodstawowƒÖ nr 31 im. gen. Hallera.\nZakres: ≈õcie≈ºka sensoryczna przy SP 31, zakup trzech\nr√≥wnowa≈ºni typu zygzak, sko≈õnej i na sprƒô≈ºynach, dw√≥ch\nzestaw√≥w paneli edukacyjnych oraz czterech pojedynczych.",
    "lat": 53.0292707,
    "lon": 18.6809993
  },
  {
    "name": "≈öcie≈ºka do≈õwiadcze≈Ñ.",
    "location": "Ul. Strza≈Çowa 15, teren SP nr 12.",
    "address": "Strza≈Çowa 15",
    "address_manual": "",
    "value": 160000,
    "category": "801",
    "description": "≈öcie≈ºka do≈õwiadcze≈Ñ.\nUl. Strza≈Çowa 15, teren SP nr 12.\nZakres: 7 urzƒÖdze≈Ñ ze ≈õcie≈ºki do≈õwiadcze≈Ñ, odtworzenie\nnawierzchni wok√≥≈Ç urzƒÖdze≈Ñ.",
    "lat": 52.9989451,
    "lon": 18.6282468
  },
  {
    "name": "Poznaj Rudak od podszewki - 3 pƒôtle ≈õcie≈ºek turystyczno- rekreacyjnych na Rudaku.",
    "location": "Osiedle Rudak.",
    "address": "Rudak",
    "address_manual": "",
    "value": 35000,
    "category": "630",
    "description": "Poznaj Rudak od podszewki - 3 pƒôtle ≈õcie≈ºek turystyczno-\nrekreacyjnych na Rudaku.\nOsiedle Rudak.\nZmiana zakresu: wytyczenie ≈õcie≈ºek, opracowanie\ntematyczne, oznakowanie tabliczkami, tablice informacyjne,\npieczƒÖtki okoliczno≈õciowe.",
    "lat": 53.0038978,
    "lon": 18.6608527
  },
  {
    "name": "Rekreacja na Rudaku - etap II, Naturalny plac zabaw.",
    "location": "Ulica Rypi≈Ñska 72-78.",
    "address": "Rypi≈Ñska 72 - 78",
    "address_manual": "",
    "value": 120000,
    "category": "900",
    "description": "Rekreacja na Rudaku - etap II, Naturalny plac zabaw.\nUlica Rypi≈Ñska 72-78.\nZakres: wyposa≈ºenie terenu rekreacyjnego w sza≈Ças\nwiklinowy, naturalne k≈Çody i pniaki, ma≈Çpi gaj, tunele oraz\nmostki, dwie ≈Çawki, bez o≈õwietlenia do limitu ≈õrodk√≥w.",
    "lat": 52.9962651,
    "lon": 18.6614744
  },
  {
    "name": "Pilates na Rudaku.",
    "location": "Filia Dworu Artusa, Dom Muz, ul. Ok√≥lna 169.",
    "address": "Ok√≥lna 169",
    "address_manual": "",
    "value": 59980,
    "category": "921",
    "description": "Pilates na Rudaku.\nFilia Dworu Artusa, Dom Muz, ul. Ok√≥lna 169.\nZmiana zakresu: zwiƒôkszenie liczby zajƒôƒá bez zakupu ≈õrodk√≥w\ntrwa≈Çych.",
    "lat": 53.0007339,
    "lon": 18.641134
  },
  {
    "name": "W ko≈Ñcu bezpieczne przej≈õcie przy Macieju!",
    "location": "Okolica pawilonu handlowego Maciej na ulicy Konstytucji 3 Maja.",
    "address": "Konstytucji 3 Maja",
    "address_manual": "",
    "value": 200000,
    "category": "600",
    "description": "W ko≈Ñcu bezpieczne przej≈õcie przy Macieju!\nOkolica pawilonu handlowego Maciej na ulicy Konstytucji 3\nMaja.\nZakres: przebudowa chodnika, zmiana oznakowania, budowa\nprzej≈õcia dla pieszych.",
    "lat": 53.0224827,
    "lon": 18.6696943
  },
  {
    "name": "Skarpolina - Dzieciƒôca Kraina.",
    "location": "Kontynuacja placu zabaw \"Skarpolina\" w lasku pomiƒôdzy blokami Bolta 6 a Bolta 8, osiedle Skarpa, Toru≈Ñ.",
    "address": "Bolta 6",
    "address_manual": "",
    "value": 264925,
    "category": "926",
    "description": "Skarpolina - Dzieciƒôca Kraina.\nKontynuacja placu zabaw \"Skarpolina\" w lasku pomiƒôdzy\nblokami Bolta 6 a Bolta 8, osiedle Skarpa, Toru≈Ñ.\nZakres: wysoka hu≈õtawka r√≥wnowa≈ºna dwuosobowa,\nhu≈õtawka dwuosobowa typu Trazan, surfer, wirujƒÖca misa,\nbƒÖczek, podw√≥jne drƒÖ≈ºki, Roll Runner, long roll, tablice\ninformacyjne.",
    "lat": 53.0204306,
    "lon": 18.6849303
  },
  {
    "name": "Kino plenerowe na Rynku Nowomiejskim.",
    "location": "Wschodnia czƒô≈õƒá Rynku Nowomiejskiego w Toruniu.",
    "address": "Rynku Nowomiejskiego",
    "address_manual": "",
    "value": 80000,
    "category": "921",
    "description": "Kino plenerowe na Rynku Nowomiejskim.\nWschodnia czƒô≈õƒá Rynku Nowomiejskiego w Toruniu.\nZakres: zmiana lokalizacji na Plac Podominika≈Ñski, minimum 8\nseans√≥w."
  },
  {
    "name": "Przebudowa i modernizacja placu zabaw przy SP 14 im. B≈Çƒôkitnej Armii w Toruniu.",
    "location": "Teren pomiƒôdzy kompleksem boisk Orlik a budynkiem dydaktycznym klas 1-3 SP nr 14, ul. Hallera 79.",
    "address": "Hallera 79",
    "address_manual": "",
    "value": 200000,
    "category": "801",
    "description": "Przebudowa i modernizacja placu zabaw przy SP 14 im.\nB≈Çƒôkitnej Armii w Toruniu.\nTeren pomiƒôdzy kompleksem boisk Orlik a budynkiem\ndydaktycznym klas 1-3 SP nr 14, ul. Hallera 79. Doj≈õcie na plac\nod ul. St. Woyczy≈Ñskiego.\nZakres: bezpieczna powierzchnia poliuretanowa, zakup\nnowych urzƒÖdze≈Ñ zabawowych, ≈Çawa kamienna.",
    "lat": 52.9961862,
    "lon": 18.6164604
  },
  {
    "name": "Renowacja chodnika przy Domu dla os√≥b najubo≈ºszych.",
    "location": "Ul. Dybowska 1, Toru≈Ñ.",
    "address": "Dybowska 1",
    "address_manual": "",
    "value": 30000,
    "category": "600",
    "description": "Renowacja chodnika przy Domu dla os√≥b najubo≈ºszych.\nUl. Dybowska 1, Toru≈Ñ.\nZakres: wymiana nawierzchni chodnika oraz naprawa\nschod√≥w.",
    "lat": 53.0015908,
    "lon": 18.6194248
  },
  {
    "name": "Przestrze≈Ñ relaksu i zabawy przy SP 9.",
    "location": "Ul. Rzepakowa 7/9, Toru≈Ñ.",
    "address": "Rzepakowa",
    "address_manual": "",
    "value": 280000,
    "category": "801",
    "description": "Przestrze≈Ñ relaksu i zabawy przy SP 9.\nUl. Rzepakowa 7/9, Toru≈Ñ.\nZakres: st√≥≈Ç do tenisa sto≈Çowego, 7 gier podw√≥rkowych, 6\n≈Çawek parkowych, uzupe≈Çnienie nawierzchni trawiastej wok√≥≈Ç\nterenu prowadzonych prac.",
    "lat": 53.0461341,
    "lon": 18.579693
  },
  {
    "name": "Stworzenie alei drzew wzd≈Çu≈º ul. Strobanda.",
    "location": "Ul. Strobanda, dotyczy terenu dzia≈Çki nr 170 od strony dzia≈Çki 162.",
    "address": "Strobanda",
    "address_manual": "",
    "value": 139622,
    "category": "900",
    "description": "Stworzenie alei drzew wzd≈Çu≈º ul. Strobanda.\nUl. Strobanda, dotyczy terenu dzia≈Çki nr 170 od strony dzia≈Çki\n162.\nZakres: nasadzenie 28-30 drzew i ich pielƒôgnacja do dobrego\nukorzenienia.",
    "lat": 53.0524108,
    "lon": 18.6044949
  },
  {
    "name": "Festyn rodzinny - spotkajmy siƒô razem.",
    "location": "Dzia≈Çka 046301_1.",
    "address": "",
    "address_manual": "",
    "value": 35000,
    "category": "900",
    "description": "Festyn rodzinny - spotkajmy siƒô razem.\nDzia≈Çka 046301_1.0032.747/7 pomiƒôdzy sklepem Intermarche\na blokiem przy ul. Watzenrodego 5.\nZakres: wystƒôpy sceniczne, pokazy umiejƒôtno≈õci, konkurencje\nsprawno≈õciowe, rywalizacje sportowe, animacje i urzƒÖdzenia\nrekreacyjne dla dzieci."
  },
  {
    "name": "≈öcianka wspinaczkowa bezpieczna dla dzieci i m≈Çodzie≈ºy ko≈Ço placu zabaw z tyrolkƒÖ.",
    "location": "Plac zabaw dla dzieci du≈ºy z tyrolkƒÖ przy ul. Watzenrodego.",
    "address": "Watzenrodego",
    "address_manual": "",
    "value": 80000,
    "category": "926",
    "description": "≈öcianka wspinaczkowa bezpieczna dla dzieci i m≈Çodzie≈ºy ko≈Ço\nplacu zabaw z tyrolkƒÖ.\nPlac zabaw dla dzieci du≈ºy z tyrolkƒÖ przy ul. Watzenrodego.\nZakres: ≈õcianka wspinaczkowa, strefa bezpiecze≈Ñstwa\npiaszczysta.",
    "lat": 53.0410622,
    "lon": 18.5990446
  }
        ]
      };

      const AVAILABLE_YEARS = Object.keys(DATA_BY_YEAR).sort().reverse();

        const MAP_CENTER = [53.0138, 18.6003];
        const MAP_ZOOM = 12;
        
        const TILE_LAYER_URL = 'https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png';
        const TILE_LAYER_ATTRIBUTION = '&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors';
        
        // Category names from https://przepisy.gofin.pl/przepisy,4,16,194,1276,,20250916,rozporzadzenie-ministra-finansow-z-dnia-2032010-r-w-sprawie.html
        const CATEGORY_NAMES = Object.freeze({
            '010': 'Rolnictwo i ≈Çowiectwo',
            '020': 'Le≈õnictwo',
            '050': 'Rybo≈Ç√≥wstwo i rybactwo',
            '100': 'G√≥rnictwo i kopalnictwo',
            '150': 'Przetw√≥rstwo przemys≈Çowe',
            '400': 'Wytwarzanie i zaopatrywanie w energiƒô elektrycznƒÖ, gaz i wodƒô',
            '500': 'Handel',
            '550': 'Hotele i restauracje',
            '600': 'Transport i ≈ÇƒÖczno≈õƒá',
            '630': 'Turystyka',
            '700': 'Gospodarka mieszkaniowa',
            '710': 'Dzia≈Çalno≈õƒá us≈Çugowa',
            '720': 'Informatyka',
            '730': 'Szkolnictwo wy≈ºsze i nauka',
            '750': 'Administracja publiczna',
            '751': 'Urzƒôdy naczelnych organ√≥w w≈Çadzy pa≈Ñstwowej, kontroli i ochrony prawa oraz sƒÖdownictwa',
            '752': 'Obrona narodowa',
            '753': 'ObowiƒÖzkowe ubezpieczenia spo≈Çeczne',
            '754': 'Bezpiecze≈Ñstwo publiczne i ochrona przeciwpo≈ºarowa',
            '755': 'Wymiar sprawiedliwo≈õci',
            '756': 'Dochody od os√≥b prawnych, od os√≥b fizycznych i od innych jednostek nieposiadajƒÖcych osobowo≈õci prawnej oraz wydatki zwiƒÖzane z ich poborem',
            '757': 'Obs≈Çuga d≈Çugu publicznego',
            '758': 'R√≥≈ºne rozliczenia',
            '801': 'O≈õwiata i wychowanie',
            '851': 'Ochrona zdrowia',
            '852': 'Pomoc spo≈Çeczna',
            '853': 'Pozosta≈Çe zadania w zakresie polityki spo≈Çecznej',
            '854': 'Edukacyjna opieka wychowawcza',
            '855': 'Rodzina',
            '900': 'Gospodarka komunalna i ochrona ≈õrodowiska',
            '921': 'Kultura i ochrona dziedzictwa narodowego',
            '925': 'Ogrody botaniczne i zoologiczne oraz naturalne obszary i obiekty chronionej przyrody',
            '926': 'Kultura fizyczna'
        });

        // Category to icon mapping using Unicode emoji
        const CATEGORY_ICONS = Object.freeze({
            '010': 'üåæ', '020': 'üå≤', '050': 'üêü', '100': '‚õèÔ∏è', '150': 'üè≠',
            '400': '‚ö°', '500': 'üõí', '550': 'üçΩÔ∏è', '630': 'üèñÔ∏è', '710': '‚öôÔ∏è', '720': 'üíª',
            '600': 'üöå', '700': 'üè†', '730': 'üéì',
            '750': 'üèõÔ∏è', '751': '‚öñÔ∏è', '752': 'üõ°Ô∏è', '753': 'üõ°Ô∏è', '754': 'üö®', '755': '‚öñÔ∏è', '756': 'üíµ', '757': 'üìä', '758': 'üìã',
            '801': 'üìö', '854': 'üë∂',
            '851': 'üíä', '852': 'ü§ù', '853': 'ü´Ç', '855': 'ü§±',
            '900': '‚ôªÔ∏è',
            '921': 'üé≠', '925': 'ü¶å', '926': '‚öΩ'
        });


        const MARKER_FILL_OPACITY = 0.4;
        const MARKER_STROKE_OPACITY = 0.6;
        
        // Square root scaling makes marker area proportional to value,
        // which is the standard cartographic method for proportional symbol maps.
        // This handles wide value ranges  while keeping all differences visible.
        const BASE_RADIUS = 20;
        const MAX_RADIUS = 40;

        let currentYear = AVAILABLE_YEARS[0];
        let currentMarkers = [];
        let minValue, maxValue;

        function getRadiusByValue(value) {
            const normalized = Math.sqrt(value / minValue);
            const maxNormalized = Math.sqrt(maxValue / minValue);
            return BASE_RADIUS + (normalized / maxNormalized) * (MAX_RADIUS - BASE_RADIUS);
        }

        function createMarker(location) {
            const icon = CATEGORY_ICONS[location.category] || 'üìç';
            const size = getRadiusByValue(location.value);
            
            const divIcon = new DivIcon({
                html: `<div style="font-size: ${size}px; line-height: 1; text-align: center;">${icon}</div>`,
                className: '',
                iconSize: [size, size],
                iconAnchor: [size / 2, size / 2]
            });

            const marker = new Marker([location.lat, location.lon], {
                icon: divIcon
            });

            const categoryName = CATEGORY_NAMES[location.category] || location.category;
            marker.bindPopup(`<b>${location.name}</b><br>Value: ${location.value.toLocaleString()} PLN<br>Category: ${categoryName}`);
            
            return marker;
        }

        function loadYear(year) {
            currentMarkers.forEach(marker => map.removeLayer(marker));
            currentMarkers = [];
            currentYear = year;

            const locations = DATA_BY_YEAR[year] || [];
            const locationsWithCoords = locations.filter(loc => loc.lat && loc.lon);
            
            if (locationsWithCoords.length === 0) return;

            const values = locationsWithCoords.map(loc => loc.value);
            minValue = Math.min(...values);
            maxValue = Math.max(...values);

            locationsWithCoords.forEach(location => {
                const marker = createMarker(location);
                marker.addTo(map);
                currentMarkers.push(marker);
            });
        }

        const YearSelector = Control.extend({
            options: {
                position: 'topright'
            },

            onAdd: function(mapInstance) {
                const container = document.createElement('div');
                container.className = 'year-selector leaflet-bar';

                const centerButton = document.createElement('button');
                centerButton.textContent = 'Wycentruj mapƒô';
                centerButton.onclick = () => {
                    mapInstance.setView(MAP_CENTER, MAP_ZOOM);
                };
                container.appendChild(centerButton);

                const selectGroup = document.createElement('div');
                selectGroup.className = 'control-group';

                const label = document.createElement('label');
                label.textContent = 'Wybierz rok: ';
                selectGroup.appendChild(label);

                const select = document.createElement('select');
                AVAILABLE_YEARS.forEach(year => {
                    const option = document.createElement('option');
                    option.value = year;
                    option.textContent = year;
                    if (year === currentYear) {
                        option.selected = true;
                    }
                    select.appendChild(option);
                });

                select.onchange = (e) => {
                    loadYear(e.target.value);
                };

                selectGroup.appendChild(select);
                container.appendChild(selectGroup);
                return container;
            }
        });

        const map = new Map('map').setView(MAP_CENTER, MAP_ZOOM);

        new TileLayer(TILE_LAYER_URL, {
            attribution: TILE_LAYER_ATTRIBUTION
        }).addTo(map);

        new YearSelector().addTo(map);
        loadYear(currentYear);
    </script>
</head>
<body>
    <div id="map"></div>
</body>
</html>
